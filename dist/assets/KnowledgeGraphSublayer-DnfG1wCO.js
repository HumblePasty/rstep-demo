const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./lclayout-CABOAFOx.js","./index-BeW5XHHa.js","./index-DuWGJfz-.css"])))=>i.map(i=>d[i]);
import{hU as et,b7 as tt,iN as nt,s as X,Y as it,gq as Z,bZ as rt,R as ue,a3 as re,fP as we,ff as K,eZ as ce,ck as he,q7 as Le,fB as We,r as y,m as h,n as Ne,k6 as at,k0 as st,k1 as ot,fX as lt,j$ as pt,gs as dt,f$ as ut,fY as yt,g0 as ct,q8 as ht,ci as ye,fQ as ie,k2 as mt,gj as fe,M as ft,k4 as gt,a2 as Tt,k3 as bt,aD as wt,bm as Et,g1 as It,H as F,q9 as Nt,qa as Lt,qb as Dt,qc as _t,k7 as Mt,k8 as Rt,k9 as vt,g3 as $t,kw as St,kx as kt,ka as Ct,qd as At,kb as Ot,gk as xt,kd as jt,mC as qt,C as Ft,py as Pt,cu as Bt}from"./index-BeW5XHHa.js";import{o as Gt}from"./featureConversionUtils-MXBZI-Ia.js";import{e as De}from"./OptimizedFeature-6cJ-QFG5.js";import{W as Ut,M as ae,r as ze}from"./knowledgeGraphService-D97EFudU.js";import{s as te}from"./Relationship-BovVR9Si.js";import{m as Ht}from"./FeatureStore-CgeuD3xw.js";import{V as Qt}from"./QueryEngine-CNrLLKAr.js";import{y as Jt,u as ge}from"./clientSideDefaults-CPjggzGP.js";const Y="ESRI__ID",Ee="ESRI__OriginID",Ie="ESRI__DestID",Ze="ESRI__LayoutGeometry",_e="ESRI__AggregationCount",le="LC.ESRI__IsSpatial",Yt={initializeLayersFromClientData:async(e,t)=>{if(t||(t=[...e.layers,...e.tables].map(s=>s.graphTypeName)),(t==null?void 0:t.length)===0)return;const i=new Map;for(const s of t)i.set(s,Me(e,s));const n=await Ut(e.dataManager.knowledgeGraph,Array.from(i.values()));for(const s of[...e.layers,...e.tables]){const r=s.objectType.name;if(r===null)continue;const a=n.get(Me(e,r));if(a){const o=JSON.parse(a);o===null||typeof o!="object"||o.hasOwnProperty("showLabels")||(o.showLabels=!1),s.read(o,{origin:"service"})}}}},Me=(e,t)=>e.type==="knowledge-graph"?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function yn(e,t){return Yt.initializeLayersFromClientData(e,t)}let Te=class ne{constructor(){this._featureLookup=new Map}static getInstance(){return ne.instance||(ne.instance=new ne),ne.instance}static resetInstance(){ne.instance&&(ne.instance=null)}deleteFromStore(t){t.forEach(i=>{this._featureLookup.delete(i)})}readFromStoreByList(t){const i=[];return t.forEach(n=>{const s=this.readFromStoreById(n);s&&i.push(s)}),i}readFromStoreById(t){return this._featureLookup.get(t)??null}writeToStore(t,i,n){const s=[];return t.forEach(r=>{if(!(r!=null&&r.id))return;r.properties||(r.properties=[]);let a,o=null;if(n&&r.properties[n]&&(o=Gt(r.properties[n])),"originId"in r&&"destinationId"in r&&(r.properties[Ee]=r.originId,r.properties[Ie]=r.destinationId),r.properties[i]=r.id,r.id&&this._featureLookup.has(r.id)&&this._featureLookup.get(r.id).attributes){const l=this._featureLookup.get(r.id),c=JSON.parse(JSON.stringify(Object.assign(l.attributes,r.properties)));n&&r.properties[n]&&(c[n]=et(r.properties[n])),a=new De(o?JSON.parse(JSON.stringify(o)):l!=null&&l.geometry?JSON.parse(JSON.stringify(l.geometry)):null,c,null,r.properties[i])}else a=new De(o?JSON.parse(JSON.stringify(o)):null,r.properties,null,r.properties[i]);this._featureLookup.set(`${r.typeName?`${r.typeName}__${r.id}`:r.id}`,a),s.push(a)}),s}},be,w=null;function cn(){return be||(be=tt(()=>import("./lclayout-CABOAFOx.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(e=>e.l).then(({default:e})=>e({locateFile:t=>nt(`esri/libs/linkchartlayout/${t}`)})).then(e=>{Vt(e)}),be)}function Vt(e){w=e}var Re,ve,pe,de;function Wt(e){const t=Object.keys(pe).filter(n=>isNaN(parseInt(n,10))).indexOf(e.timeDirection),i=Object.keys(de).filter(n=>isNaN(parseInt(n,10))).indexOf(e.eventsTicksVisualization);return{timeDirection:{value:t>-1?t:pe.right},timeBannerUTCOffsetInMinutes:e.timeBannerUTCOffsetInMinutes,eventsTicksVisualization:{value:i>-1?i:de.startAndEnd},showDurationLineForNonZeroDurationEntityEvents:e.showDurationLineForNonZeroDurationEntityEvents,durationLineWidth:e.durationLineWidth,entityPositionAtDurationRatio:e.entityPositionAtDurationRatio,showNonZeroDurationIntervalBounds:e.showNonZeroDurationIntervalBounds,separateTimeOverlaps:e.separateTimeOverlaps,separateTimelineOverlaps:e.separateTimelineOverlaps,moveFirstBends:e.moveFirstBends,secondBendRatio:e.secondBendRatio,lineSeparationMultiplier:e.lineSeparationMultiplier,spaceSeparatedLinesEvenly:e.spaceSeparatedLinesEvenly,useBezierCurves:e.useBezierCurves,separatedLineShapeRatio:e.separatedLineShapeRatio}}function ee(e,t,i,n,s,r){const a=i.length,o=s.length,l=Float64Array.BYTES_PER_ELEMENT,c=Uint32Array.BYTES_PER_ELEMENT,m=Uint8Array.BYTES_PER_ELEMENT,d=16,u=d+a*(m+2*l)+o*(2*c),b=w._malloc(u);try{const I=b+d-b%d,p=I+a*l,N=p+a*l,M=N+o*c,k=M+o*c,z=()=>[w.HEAPF64.subarray(I>>3,(I>>3)+a),w.HEAPF64.subarray(p>>3,(p>>3)+a),w.HEAPU32.subarray(N>>2,(N>>2)+o),w.HEAPU32.subarray(M>>2,(M>>2)+o),w.HEAPU8.subarray(k,k+a)],[B,O,v,A,G]=z();B.set(i),O.set(n),v.set(s),A.set(r),G.set(t);let x=e(a,k,I,p,o,N,M),j=null,q=null;if(x){const f=w.getLayoutLinksTypes(),C=w.getLayoutLinksVerticesEndIndices(),$=w.getLayoutLinksVertices(),S=w.countLayoutLinksVertices();!o||f&&C?S&&!$?x=!1:(j={types:new Uint8Array(w.HEAPU8.subarray(f,f+o)),vertexEndIndex:new Uint32Array(w.HEAPU32.subarray(C>>2,(C>>2)+o)),vertices:new Float64Array(w.HEAPF64.subarray($>>3,($>>3)+2*S))},q=w.getAuxiliaryGraphicElements()):x=!1}const[U,H,Q,W,L]=z();return i.set(U),n.set(H),s.set(Q),r.set(W),t.set(L),{success:x,links:j,graphics:q}}finally{w._free(b),w.cleanupLayout()}}(function(e){e[e.None=0]="None",e[e.IsMovable=1]="IsMovable",e[e.IsGeographic=2]="IsGeographic",e[e.IsRoot=4]="IsRoot",e[e.IsOld=8]="IsOld"})(Re||(Re={})),function(e){e[e.Regular=0]="Regular",e[e.Curved=1]="Curved",e[e.Recursive=2]="Recursive"}(ve||(ve={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.top=2]="top",e[e.bottom=3]="bottom"}(pe||(pe={})),function(e){e[e.none=0]="none",e[e.startOnly=1]="startOnly",e[e.startAndEnd=2]="startAndEnd"}(de||(de={}));const $e=2,Se=1,ke=-1;var Ce,Ae,Oe,xe,je,qe,Fe,Pe,Be;(function(e){function t(){return w.getMinIdealEdgeLength()}function i(n,s,r,a,o,l=$e,c=Se,m=ke){return ee((d,u,b,I,p,N,M)=>w.applyForceDirectedLayout(d,u,b,I,p,N,M,l,c,m),n,s,r,a,o)}e.getMinIdealEdgeLength=t,e.apply=i})(Ce||(Ce={})),function(e){function t(i,n,s,r,a,o=$e,l=Se,c=ke){return ee((m,d,u,b,I,p,N)=>w.applyCommunityLayout(m,d,u,b,I,p,N,o,l,c),i,n,s,r,a)}e.apply=t}(Ae||(Ae={})),function(e){function t(i,n,s,r,a){return ee(w.applySimpleLayout,i,n,s,r,a)}e.apply=t}(Oe||(Oe={})),function(e){function t(i,n,s,r,a){return ee(w.applyHierarchicalLayout,i,n,s,r,a)}e.apply=t}(xe||(xe={})),function(e){function t(i,n,s,r,a){return ee(w.applyRadialTreeLayout,i,n,s,r,a)}e.apply=t}(je||(je={})),function(e){function t(i,n,s,r,a){return ee(w.applySmartTreeLayout,i,n,s,r,a)}e.apply=t}(qe||(qe={})),function(e){function t(i,n,s,r,a,o,l,c,m,d,u){const b={timeDirection:pe.right,timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:de.startAndEnd,showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0};return ee((I,p,N,M,k,z,B)=>{if(r.length!==I||a.length!==I||c.length!==k||m.length!==k)return!1;const O=Float64Array.BYTES_PER_ELEMENT,v=16,A=w._malloc(v+I*O),G=w._malloc(v+I*O),x=w._malloc(v+k*O),j=w._malloc(v+k*O),q=A+v-A%v,U=G+v-G%v,H=x+v-x%v,Q=j+v-j%v;try{w.HEAPF64.subarray(q>>3,(q>>3)+I).set(r),w.HEAPF64.subarray(U>>3,(U>>3)+I).set(a),w.HEAPF64.subarray(H>>3,(H>>3)+k).set(c),w.HEAPF64.subarray(Q>>3,(Q>>3)+k).set(m);const W=Wt(Object.assign(b,u));return w.applyChronologicalLayout(I,p,N,M,q,U,k,z,B,H,Q,d,W)}finally{w._free(A),w._free(G),w._free(x),w._free(j)}},i,n,s,o,l)}e.apply=t}(Fe||(Fe={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(Pe||(Pe={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(Be||(Be={}));var me;(function(e){e.ELEMENTUID="ELEMENTUID",e.TYPENAME="TYPENAME"})(me||(me={}));me.ELEMENTUID,me.TYPENAME;var Ge,Ue;(function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"})(Ge||(Ge={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(Ue||(Ue={}));var He,Qe,Je,se;(function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"})(He||(He={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(Qe||(Qe={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(Je||(Je={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(se||(se={}));function zt(e){if(!e.spatialReference.isWGS84)throw new X("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map(t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]])}async function hn(e,t){var r,a;const i=[],n=new Map,s=[];if((r=t.dataModel)!=null&&r.relationshipTypes)for(const o of t.dataModel.relationshipTypes)o.name&&n.set(o.name,[]);for(const o of e)n.has(o.typeName)&&((a=n.get(o.typeName))==null||a.push(o.id));for(const[o,l]of n){if(l.length<1)continue;const c=new te({openCypherQuery:`MATCH (n)-[r:${o}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:l}});s.push(ae(t,c).then(async m=>{const d=m.resultRowsStream.getReader();for(;;){const{done:u,value:b}=await d.read();if(u)break;for(const I of b)i.push({id:I[0],typeName:I[1]}),i.push({id:I[2],typeName:I[3]})}}))}return await Promise.all(s),i}async function mn(e,t){t??(t=!1);const i={generateAllSublayers:t,namedTypeDefinitions:new Map};return await Kt(e).then(n=>{en(n,i)}),i}async function fn(e){const t=await ze(),i=new t.MapOfObjectIdentifierSets;Zt(i,t,e);const n=new t.MapOfObjectIdentifierSetsEncoder;try{n.set_map_of_identifier_sets(i),n.encode();const s=n.get_encoding_result();if(s.error.error_code!==0)throw new X("knowledge-graph:layer-support-utils",s.error.error_message);const r=structuredClone(s.get_byte_buffer());return n.delete(),r}finally{i.delete()}}function Zt(e,t,i){for(const[n,s]of i.namedTypeDefinitions){if(!s.members||s.useAllData)continue;const r=s.members.keys();let a=!1,o=!0;const l=new t.ObjectIdArray,c=new t.StringArray,m=new t.GlobalIdArray,d=new t.IdentifierArray,u=new t.ObjectIdentifierSet;for(const b of r)o&&(a=!isNaN(Number(b)),o=!1),a?l.add_objectid(Number(b)):(c.add_string(b),m.add_globalid(b)),d.add_identifier(b);u.set_oid_array(l),u.set_string_array(c),u.set_globalid_array(m),u.set_identifier_array(d),l.delete(),c.delete(),m.delete(),d.delete(),e.put_identifier_set(n,u),u.delete()}return e}async function Kt(e){const t=await it(e,{responseType:"array-buffer"}),i=await t.data;return Xt(new Uint8Array(i))}async function Xt(e){const t=new(await ze()).MapOfObjectIdentifierSetsDecoder,i=t.decode(new Uint8Array(e)),n=new Map;if(i.error_code!==0)throw new X("knowledge-graph:layer-support-utils",i.error_message);const s=t.get_map_of_identifier_sets(),r=s.keys,a=r.size();for(let o=0;o<a;o++){const l=r.get(o),c=s.query_identifier_set(l),m=[];if(c.id_array_type.value===se.GLOBALID_ARRAY){const d=c.get_globalid_array(),u=d.count();for(let b=0;b<u;b++)m.push(d.get_globalid_at(b))}else if(c.id_array_type.value===se.IDENTIFIER_ARRAY){const d=c.get_identifier_array(),u=d.count();for(let b=0;b<u;b++)m.push(d.get_identifier_at(b).toString())}else if(c.id_array_type.value===se.STRING_ARRAY){const d=c.get_string_array(),u=d.count();for(let b=0;b<u;b++)m.push(d.get_string_at(b))}else{if(c.id_array_type.value!==se.OID_ARRAY)throw new X("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const d=c.get_oid_array(),u=d.count();for(let b=0;b<u;b++)m.push(d.get_objectid_at(b).toString())}}n.set(l,m)}return t.delete(),n}function en(e,t){for(const[i,n]of e){const s=Z(t.namedTypeDefinitions,i,()=>({useAllData:!1,members:new Map}));for(const r of n)s.members.has(r)||s.members.set(r,{id:r})}return t}let J=class extends rt{constructor(e){var i,n,s;super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;(i=e.knowledgeGraph.dataModel.entityTypes)==null||i.forEach(r=>{var a,o;r.name&&(t.set(r.name,"entity"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!((a=e.inclusionModeDefinition)!=null&&a.generateAllSublayers)||this.entityTypeNames.add(r.name),(o=r.properties)==null||o.forEach(l=>{l.geometryType&&l.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(r.name,{name:l.name??"",geometryType:l.geometryType})}))}),(n=e.knowledgeGraph.dataModel.relationshipTypes)==null||n.forEach(r=>{var a,o;r.name&&(t.set(r.name,"relationship"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!((a=e.inclusionModeDefinition)!=null&&a.generateAllSublayers)||this.relationshipTypeNames.add(r.name),(o=r.properties)==null||o.forEach(l=>{l.geometryType&&l.geometryType!=="esriGeometryNull"&&this.geographicLookup.set(r.name,{name:l.name??"",geometryType:l.geometryType})}))}),(s=e.inclusionModeDefinition)==null||s.namedTypeDefinitions.forEach((r,a)=>{var l,c;if(t.get(a)==="entity")this.entityTypeNames.add(a);else{if(t.get(a)!=="relationship")return ue.getLogger(this).warn(`A named type, ${a}, was in the inclusion list that wasn't in the data model and will be removed`),void((l=e.inclusionModeDefinition)==null?void 0:l.namedTypeDefinitions.delete(a));this.relationshipTypeNames.add(a)}const o=new Map;(c=r.members)==null||c.forEach(m=>{Z(this.memberIdTypeLookup,m.id,()=>new Set).add(a);const d=this.getById(m.id);d&&o.set(m.id,d)}),this.sublayerCaches.set(a,o)})}addToLayer(e){e.forEach(({typeName:t,id:i})=>{if(!this.inclusionModeDefinition)throw new X("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(t)){const n=this.inclusionModeDefinition.namedTypeDefinitions.get(t);n.members||(n.members=new Map),n.members.set(i,{id:i}),Z(this.memberIdTypeLookup,i,()=>new Set).add(t)}}else{const n=new Map;n.set(i,{id:i}),this.inclusionModeDefinition.namedTypeDefinitions.set(t,{useAllData:!1,members:n}),Z(this.memberIdTypeLookup,i,()=>new Set).add(t)}})}getById(e){return Te.getInstance().readFromStoreById(e)}async getData(e,t,i){var s,r;if(t.objectType.name&&((s=this.inclusionModeDefinition)!=null&&s.namedTypeDefinitions)&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let n;if(n=e||new re({where:"1=1",outFields:["*"]}),t.parentCompositeLayer.type==="link-chart"){const a=t.parentCompositeLayer,o=this._processingCacheUpdatesLookup.get(t.objectType.name??""),l=n.outFields;l&&l.length===1&&l[0]===Y&&n.where==="1=1"||await Promise.all(o??[]);const c=this.sublayerCaches.has(t.objectType.name??"")?Array.from((r=this.sublayerCaches.get(t.objectType.name))==null?void 0:r.values()):[],m=[];return c.forEach(d=>{if(this.relationshipTypeNames.has(t.objectType.name)){d.geometry=a.relationshipLinkChartDiagramLookup.get(d.attributes[t.objectIdField]);const u=this.memberIdTypeLookup.get(d.attributes[Ee]),b=this.memberIdTypeLookup.get(d.attributes[Ie]),I=this._isEndEntitySpatial(u,d,Ee),p=this._isEndEntitySpatial(b,d,Ie);d.attributes[le]=Number(I&&p)}else{d.geometry=a.entityLinkChartDiagramLookup.get(d.attributes[t.objectIdField]);const u=this.geographicLookup.get(t.objectType.name);u&&d.attributes[u.name]?d.attributes[le]=1:d.attributes[le]=0}d.attributes[Ze]=d.geometry,m.push(d)}),m}return this.retrieveDataFromService(n,t,i)}async getConnectedRecordIds(e,t){const i=[];let n="";const s=[],r=new Map;if(e.forEach(m=>{var d;if(this.memberIdTypeLookup.has(m))for(const u of this.memberIdTypeLookup.get(m)){if(!this.entityTypeNames.has(u))return;r.has(u)?(d=r.get(u))==null||d.push(m):r.set(u,[m])}}),t&&(t==null?void 0:t.length)!==0){for(const m of t)n=n+m+"|";n=n.slice(0,-1)}const a={};let o="",l=-1;for(const[m,d]of r){l++,l!==0&&(o+=" UNION ");const u=`${m}_ids`;a[u]=d,o+=t&&(t==null?void 0:t.length)!==0?`MATCH (n:${m}) WHERE id(n) IN $${u} WITH n MATCH (n)-[r:${n}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${m}) WHERE id(n) IN $${u} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`}if(!o)return i;const c=new Promise(m=>{(async()=>{const d=(await ae(this.knowledgeGraph,new te({openCypherQuery:o,bindParameters:a}))).resultRowsStream.getReader();try{for(;;){const{done:u,value:b}=await d.read();if(u)break;for(let I=0;I<b.length;I++){const p=b[I];i.push({id:p[0],typeName:p[1]}),i.push({id:p[2],typeName:p[3]})}}}catch(u){if(u.name!=="AbortError")throw u;ue.getLogger(this).info("Request aborted as expected")}})().then(()=>{m()})});return s.push(c),this.refreshCacheContent(),await Promise.all(s),i}async getRelationshipsBetweenNodes(e,t){const i=[],n="MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",s=(await ae(this.knowledgeGraph,new te({openCypherQuery:n,bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:r,value:a}=await s.read();if(r)break;for(let o=0;o<a.length;o++){const l=a[o];i.push({id:l[0],typeName:l[1]})}}}catch(r){if(r.name!=="AbortError")throw r;ue.getLogger(this).info("Request aborted as expected")}return i}async getRelationshipsFromNodes(e,t,i){const n=[],s="MATCH (n)-[r]-(m) WHERE id(n) IN $targetEntityIds AND id(m) in $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",r=(await ae(this.knowledgeGraph,new te({openCypherQuery:s,bindParameters:{targetEntityIds:e,possibleConnectionEntityIds:t,relationshipExclusionIds:i}}))).resultRowsStream.getReader();try{for(;;){const{done:a,value:o}=await r.read();if(a)break;for(let l=0;l<o.length;l++){const c=o[l];n.push({id:c[0],typeName:c[1]})}}}catch(a){if(a.name!=="AbortError")throw a;ue.getLogger(this).info("Request aborted as expected")}return n}async refreshCacheContent(e,t,i,n=!0){var l,c,m,d,u,b,I;const s=Te.getInstance(),r=[],a=new Map,o=new Map;(l=this.knowledgeGraph.dataModel.entityTypes)==null||l.forEach(p=>{p.name&&o.set(p.name,p)}),(c=this.knowledgeGraph.dataModel.relationshipTypes)==null||c.forEach(p=>{p.name&&o.set(p.name,p)}),e||this.inclusionModeDefinition?e?e.forEach(p=>{var N;if(this.memberIdTypeLookup.has(p))for(const M of this.memberIdTypeLookup.get(p))a.has(M)?(N=a.get(M))==null||N.push(p):a.set(M,[p])}):(d=(m=this.inclusionModeDefinition)==null?void 0:m.namedTypeDefinitions)==null||d.forEach((p,N)=>{p.useAllData?a.set(N,null):p.members&&p.members.forEach(M=>{var k;a.has(N)&&a.get(N)!==null?(k=a.get(N))==null||k.push(M.id):a.set(N,[M.id])})}):((u=this.knowledgeGraph.dataModel.entityTypes)==null||u.forEach(p=>{p.name&&a.set(p.name,null)}),(b=this.knowledgeGraph.dataModel.entityTypes)==null||b.forEach(p=>{p.name&&a.set(p.name,null)}));for(const[p,N]of a){const M=new Promise(k=>{(async()=>{var j,q,U,H,Q,W,L;const B=new Set,O=[];let v,A="",G=!1;if(t||((q=(j=o.get(p))==null?void 0:j.properties)==null||q.forEach(f=>{f.name&&B.add(f.name)})),i&&this.geographicLookup.has(p)){const f=(U=this.geographicLookup.get(p))==null?void 0:U.name;f&&B.add(f)}if(this.entityTypeNames.has(p))A=`MATCH (n:${p}) ${N?"WHERE id(n) IN $ids ":""}return ID(n)`,B.forEach(f=>{A+=`, n.${f}`,O.push(f)});else{if(!this.relationshipTypeNames.has(p))throw new X("knowledge-graph:layer-data-manager",`The graph type of ${p} could not be determined. Was this type set in the KG data model and inclusion definition?`);G=!0,A=`MATCH ()-[n:${p}]->() ${N?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,B.forEach(f=>{A+=`, n.${f}`,O.push(f)})}v=new te(N?{openCypherQuery:A,bindParameters:{ids:N}}:{openCypherQuery:A});const x=(await ae(this.knowledgeGraph,v)).resultRowsStream.getReader();for(;;){const{done:f,value:C}=await x.read();if(f)break;const $=[];for(let D=0;D<C.length;D++){const E=C[D];let g=0,V=0;const R={properties:{}};for(R.id=E[g],g++,V++,G&&(R.originId=E[g],g++,V++,R.destinationId=E[g],g++,V++,Z(this.nodeConnectionsLookup,R.originId,()=>new Set).add(R.id),Z(this.nodeConnectionsLookup,R.destinationId,()=>new Set).add(R.id),Z(this.relationshipConnectionsLookup,R.id,()=>[R.originId,R.destinationId]));g<E.length;g++)R.properties[O[g-V]]=E[g];$.push(R)}const S=s.writeToStore($,Y,(H=this.geographicLookup.get(p))==null?void 0:H.name);this.sublayerCaches.has(p)||this.sublayerCaches.set(p,new Map),n&&!((Q=this.inclusionModeDefinition)!=null&&Q.namedTypeDefinitions.has(p))&&((W=this.inclusionModeDefinition)==null||W.namedTypeDefinitions.set(p,{useAllData:!1,members:new Map})),n&&!((L=this.inclusionModeDefinition)!=null&&L.namedTypeDefinitions.get(p).members)&&(this.inclusionModeDefinition.namedTypeDefinitions.get(p).members=new Map);const _=this.sublayerCaches.get(p);S.forEach(D=>{var E,g;_==null||_.set(D.attributes[Y],D),n&&!((E=this.inclusionModeDefinition)!=null&&E.namedTypeDefinitions.get(p).members.has(D.attributes[Y]))&&((g=this.inclusionModeDefinition)==null||g.namedTypeDefinitions.get(p).members.set(D.attributes[Y],{id:D.attributes[Y]}),Z(this.memberIdTypeLookup,D.attributes[Y],()=>new Set).add(p))})}})().then(()=>{k(null)})});r.push(M),(I=this._processingCacheUpdatesLookup.get(p))==null||I.push(M)}await Promise.all(r)}removeFromLayer(e){var n,s,r;const t=new Set,i=new Set(e.map(a=>a.id));for(const a of e)t.add(a.typeName),((n=this.memberIdTypeLookup.get(a.id))==null?void 0:n.size)===1?this.memberIdTypeLookup.delete(a.id):(s=this.memberIdTypeLookup.get(a.id))==null||s.delete(a.typeName),(r=this.inclusionModeDefinition)==null||r.namedTypeDefinitions.forEach((o,l)=>{var c;l===a.typeName&&((c=o.members)!=null&&c.has(a.id))&&o.members.delete(a.id)});t.forEach(a=>{var o;(o=this.sublayerCaches.get(a))==null||o.forEach((l,c)=>{var m;i.has(c)&&((m=this.sublayerCaches.get(a))==null||m.delete(c))})})}async retrieveDataFromService(e,t,i){var I,p,N,M,k,z,B,O,v,A,G,x,j,q,U,H,Q,W;const n=Te.getInstance(),s=new Set,r=[];let a,o="",l=[];const c=t.graphType==="relationship",m=(N=(p=(I=this.inclusionModeDefinition)==null?void 0:I.namedTypeDefinitions)==null?void 0:p.get(t.objectType.name))==null?void 0:N.useAllData,d=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let u=!m&&d?Array.from(d).sort():null;if((z=(k=(M=this.inclusionModeDefinition)==null?void 0:M.namedTypeDefinitions)==null?void 0:k.get(t.objectType.name))!=null&&z.useAllData)(v=(O=(B=this.inclusionModeDefinition)==null?void 0:B.namedTypeDefinitions)==null?void 0:O.get(t.objectType.name))!=null&&v.useAllData&&e.objectIds!=null&&(u=e.objectIds);else if(e.objectIds!=null&&u&&u.length>0){const L=e.objectIds;e.objectIds=u.filter(f=>L.includes(f))}else if(e.objectIds!=null)u=e.objectIds;else{if((A=this.inclusionModeDefinition)!=null&&A.namedTypeDefinitions.has(t.objectType.name)&&(!((G=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))!=null&&G.members)||((j=(x=this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name))==null?void 0:x.members)==null?void 0:j.size)<1))return e.objectIds=[],[];e.objectIds=u}if(e.outFields!=null){const L=e.outFields;L.includes("*")?t.fields.forEach(f=>{s.add(f.name)}):L.forEach(f=>{f!==Y&&f!==t.geometryFieldName&&s.add(f)})}if(e.geometry!=null){const L=e.geometry;let f;const C=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,$=C==null?void 0:C.spatialReference,S=(q=C==null?void 0:C.serviceCapabilities)==null?void 0:q.geometryCapabilities;let _=S==null?void 0:S.geometryMaxBoundingRectangleSizeX,D=S==null?void 0:S.geometryMaxBoundingRectangleSizeY;if(L.type==="point"){let E=L;(U=E.spatialReference)!=null&&U.isWGS84||(await we(E.spatialReference,K),E=ce(E,K)),f=new he({spatialReference:K,xmin:E.x-1e-4,ymin:E.y-1e-4,xmax:E.x+1e-4,ymax:E.y+1e-4})}else(H=L==null?void 0:L.extent)!=null&&H.spatialReference&&!((Q=L.spatialReference)!=null&&Q.isWGS84)?(await we(L.extent.spatialReference,K),f=ce(L.extent,K)):f=L.extent;if(_&&D&&$){if($.wkid!==4326){const E=new he({spatialReference:$,xmax:_,ymax:D}),g=ce(E,K);_=g.xmax,D=g.ymax}if(f.xmax-f.xmin>_)throw new X("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${_}° latitude, limit exceeded`);if(f.ymax-f.ymin>D)throw new X("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${D}° longitude, limit exceeded`)}if(e.where!=null&&e.where!=="1=1"){const E=await Le(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach(g=>{E.fieldNames.includes(g.name)&&s.add(g.name)})}o=c?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&s.add(t.geometryFieldName),s.forEach(E=>{o+=`, n.${E}`,r.push(E)}),a=new te({openCypherQuery:o,bindParameters:{param_filter_geom:new We({rings:zt(f)})}})}else{let L="";if(e.where!=null&&e.where!=="1=1"){const $=await Le(e.where,t.fieldsIndex);t.fields.forEach(g=>{$.fieldNames.includes(g.name)&&s.add(g.name)});const S=new Set(["column-reference","string","number","binary-expression"]),_=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let D=!1;const E=g=>{if(g.type==="column-reference")return`n.${g.column}`;if(g.type==="string")return`'${g.value}'`;if(g.type==="number")return`${g.value}`;if(g.type==="binary-expression"&&S.has(g.left.type)&&S.has(g.right.type)&&_.has(g.operator))return`${E(g.left)} ${g.operator} ${E(g.right)}`;if(g.type==="binary-expression"&&g.operator==="LIKE"){let V="";if(g.left.type==="function"&&g.left.args.value[0].type==="column-reference")V+=`lower(n.${g.left.args.value[0].column})`;else{if(g.left.type!=="column-reference")return D=!0,"";V+=`lower(n.${g.left.column})`}if(V+=" CONTAINS (",g.right.type!=="string")return D=!0,"";{let R=g.right.value;R.charAt(0)==="%"&&(R=R.slice(1)),R.charAt(R.length-1)==="%"&&(R=R.slice(0,-1)),V+=`'${R.toLowerCase()}')`}return V}return D=!0,""};L=E($.parseTree),D&&(L="")}let f="";f=c?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let C=!1;u&&(C=!0,f+=" WHERE ID(n) IN $ids"),L&&(f+=C?" AND":" WHERE",f+=` ${L}`),f+=" return ID(n)",c&&(f+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&s.add(t.geometryFieldName),s.forEach($=>{f+=`, n.${$}`,r.push($)}),a=new te(u?{openCypherQuery:f,bindParameters:{ids:u}}:{openCypherQuery:f})}const b=(await ae(t.parentCompositeLayer.dataManager.knowledgeGraph,a,i)).resultRowsStream.getReader();for(;;){const{done:L,value:f}=await b.read();if(L)break;const C=[];for(let $=0;$<f.length;$++){const S=f[$];let _=0,D=0;const E={properties:{}};for(E.id=S[_],_++,D++,c&&(E.originId=S[_],_++,D++,E.destinationId=S[_],_++,D++);_<S.length;_++)E.properties[r[_-D]]=S[_];C.push(E)}l=l.concat(n.writeToStore(C,Y,(W=t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name))==null?void 0:W.name))}return l}_isEndEntitySpatial(e,t,i){var n;for(const s of e??[])if(this.entityTypeNames.has(s)){const r=this.geographicLookup.get(s),a=r&&((n=this.sublayerCaches.get(s))==null?void 0:n.get(t.attributes[i]));if(r&&(a!=null&&a.attributes[r.name]))return!0}return!1}};y([h()],J.prototype,"knowledgeGraph",void 0),y([h()],J.prototype,"inclusionModeDefinition",void 0),y([h()],J.prototype,"entityTypeNames",void 0),y([h()],J.prototype,"relationshipTypeNames",void 0),y([h()],J.prototype,"geographicLookup",void 0),y([h()],J.prototype,"sublayerCaches",void 0),y([h()],J.prototype,"nodeConnectionsLookup",void 0),y([h()],J.prototype,"relationshipConnectionsLookup",void 0),y([h()],J.prototype,"memberIdTypeLookup",void 0),J=y([Ne("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],J);const Ye=at(),tn=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return y([h(Ye.fields)],t.prototype,"fields",void 0),y([h(Ye.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=y([Ne("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};function P(e){if(!e.json)return e;e.json.write=Ve(e.json.write);const t=e.json.origins;if(!t)return e;let i;for(i in t){const n=t[i];n&&(n.write=Ve(n.write))}return e}function Ve(e){return typeof e=="object"&&e?(e.enabled!==!1&&(e.overridePolicy=nn(e)),e):e===!0?oe():e}function nn(e){const{target:t,writer:i,overridePolicy:n,...s}=e;return function(r,a){const o=Ke.call(this,r,a);return o.enabled?{...s,...o}:o}}function oe(){return{overridePolicy:Ke}}function Ke(e,t){const i=!!this.geometryType;let n={enabled:i};return i&&(n={...n,...Xe.call(this,e,t)}),n}function Xe(e,t){return{ignoreOrigin:this.originIdOf(t)>Bt.DEFAULTS}}let T=class extends tn(st(ot(lt(pt(dt(ut(yt(ct(It))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=Jt(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=Y,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then(()=>{const t=new MessageChannel;return new ht(t.port1,{channel:t,client:{queryFeatures:(i,n={})=>{const s=re.fromJSON(i);return this.queryFeaturesJSON(s,n)}}}),[t.port2]})},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){var t,i;const e=[];return(i=(t=this.objectType)==null?void 0:t.properties)==null||i.forEach(n=>{const s=n.fieldType==="esriFieldTypeOID"?"esriFieldTypeInteger":n.fieldType;e.push(ye.fromJSON({name:n.name,type:s,alias:n.alias,defaultValue:n.defaultValue,editable:n.editable,nullable:n.nullable}))}),e.push(ye.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),ye.fromJSON({name:_e,type:"esriFieldTypeInteger",alias:_e,editable:!1}),ye.fromJSON({name:le,type:"esriFieldTypeInteger",alias:le,editable:!1})),e}get geometryType(){var i,n,s;if(((i=this.parentCompositeLayer)==null?void 0:i.type)==="link-chart")return this.graphType==="relationship"?"polyline":"point";const e=(s=this.parentCompositeLayer)==null?void 0:s.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.geometryType;return t&&t!=="esriGeometryNull"?ie.fromJSON(t):null}get geometryFieldName(){var t,i,n;if(((t=this.parentCompositeLayer)==null?void 0:t.type)==="link-chart")return Ze;const e=(n=this.parentCompositeLayer)==null?void 0:n.dataManager.geographicLookup.get((i=this.objectType)==null?void 0:i.name);return(e==null?void 0:e.name)??null}get graphTypeName(){var e;return(e=this.objectType)==null?void 0:e.name}get hasM(){var n,s,r,a;const e=(s=this.parentCompositeLayer)==null?void 0:s.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.name,i=t?(a=(r=this.objectType)==null?void 0:r.properties)==null?void 0:a[t]:null;return(i==null?void 0:i.hasM)??!1}get hasZ(){var n,s,r,a;const e=(s=this.parentCompositeLayer)==null?void 0:s.dataManager.geographicLookup.get((n=this.objectType)==null?void 0:n.name),t=e==null?void 0:e.name,i=t?(a=(r=this.objectType)==null?void 0:r.properties)==null?void 0:a[t]:null;return(i==null?void 0:i.hasZ)??!1}set renderer(e){mt(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){var e;return this._isOverridden("renderer")?this._get("renderer"):((e=this.parentCompositeLayer)==null?void 0:e.type)==="link-chart"?this.graphType==="relationship"?fe(ge(ie.toJSON("polyline")).renderer):fe(ge(ie.toJSON("point")).renderer):fe(ge(ie.toJSON(this.geometryType)).renderer)}get spatialReference(){var e,t,i,n;return((n=(i=(t=(e=this.parentCompositeLayer)==null?void 0:e.dataManager)==null?void 0:t.knowledgeGraph)==null?void 0:i.dataModel)==null?void 0:n.spatialReference)??ft.WGS84}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return gt(this,e)}createQuery(){return new re({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e),s=Tt.fromJSON(await n.executeQuery(i.toJSON(),t==null?void 0:t.signal));return s.features.forEach(r=>{r.sourceLayer=this}),s}async queryFeaturesJSON(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return await n.executeQuery(i.toJSON(),t==null?void 0:t.signal)}async queryFeatureCount(e,t){const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return n.executeQueryForCount(i.toJSON(),t==null?void 0:t.signal)}async queryExtent(e={},t){var o,l,c,m;const i={...e,returnGeometry:!0},{resolvedQuery:n,queryEngine:s}=await this._setupQueryObjects(i),r=await s.executeQueryForExtent(n.toJSON(),t==null?void 0:t.signal);let a;return a=((o=r.extent)==null?void 0:o.xmin)!=null&&((l=r.extent)==null?void 0:l.xmax)!=null&&((c=r.extent)==null?void 0:c.ymin)!=null&&((m=r.extent)==null?void 0:m.ymax)!=null?new he(r.extent):new he,{count:r.count,extent:a}}async queryObjectIds(e,t){const i=re.from(e);let n;if(this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)n=this._cachedQueryEngine;else{const s=await this.parentCompositeLayer.dataManager.getData(i,this,t);n=this.loadQueryEngine(s)}return n.executeQueryForIds(i.toJSON(),t==null?void 0:t.signal)}loadQueryEngine(e){var n;const t=new Ht({geometryType:ie.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),i=new Qt({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:ie.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:(n=this.timeInfo)==null?void 0:n.toJSON(),featureStore:t});return i.featureStore.addMany(e),i}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new re({where:"1=1",outFields:[Y]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then(()=>{bt(this.timeInfo,this.fieldsIndex)})),Promise.resolve(this)}async _setupQueryObjects(e,t){var r;const i=re.from(e),n=i.geometry;let s;if(n&&!((r=n.spatialReference)!=null&&r.isWGS84)&&(await we(n.spatialReference,K),i.geometry=ce(n instanceof We||n instanceof wt||n instanceof Et?n:n.extent,K)),this.parentCompositeLayer.type==="link-chart"&&this._cachedQueryEngine)s=this._cachedQueryEngine;else{const a=await this.parentCompositeLayer.dataManager.getData(i,this,t);s=this.loadQueryEngine(a)}return{resolvedQuery:i,queryEngine:s}}};y([h(P(F(Nt)))],T.prototype,"blendMode",void 0),y([h()],T.prototype,"capabilities",void 0),y([h({json:{origins:{"web-scene":{write:!1}},write:oe()}})],T.prototype,"charts",void 0),y([h({readOnly:!0})],T.prototype,"defaultPopupTemplate",null),y([h({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],T.prototype,"definitionExpression",void 0),y([h()],T.prototype,"displayField",void 0),y([h(P(F(Lt)))],T.prototype,"effect",void 0),y([h()],T.prototype,"elevationInfo",void 0),y([h(P(F(Dt)))],T.prototype,"featureEffect",void 0),y([h(P(F(_t)))],T.prototype,"featureReduction",null),y([h()],T.prototype,"fields",null),y([h()],T.prototype,"geometryType",null),y([h()],T.prototype,"geometryFieldName",null),y([h({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],T.prototype,"graphType",void 0),y([h({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],T.prototype,"graphTypeName",null),y([h()],T.prototype,"hasM",null),y([h()],T.prototype,"hasZ",null),y([h({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],T.prototype,"id",void 0),y([h(P(F(Mt)))],T.prototype,"labelsVisible",void 0),y([h({type:[vt],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:Rt,write:oe()}})],T.prototype,"labelingInfo",void 0),y([h({readOnly:!0,json:{read:!1,write:{writer(e,t){switch(this.parentCompositeLayer.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],T.prototype,"layerType",void 0),y([h(P(F($t)))],T.prototype,"legendEnabled",void 0),y([h(P(F(St)))],T.prototype,"maxScale",void 0),y([h(P(F(kt)))],T.prototype,"minScale",void 0),y([h()],T.prototype,"objectIdField",void 0),y([h()],T.prototype,"objectType",void 0),y([h(P(F(Ct)))],T.prototype,"opacity",void 0),y([h(P(F(At)))],T.prototype,"orderBy",void 0),y([h({clonable:!1})],T.prototype,"parent",void 0),y([h()],T.prototype,"parentCompositeLayer",void 0),y([h(P(F(Ot)))],T.prototype,"popupEnabled",void 0),y([h({type:xt,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],T.prototype,"popupTemplate",void 0),y([h({type:Number,json:{write:{overridePolicy:Xe}}})],T.prototype,"refreshInterval",void 0),y([h({types:jt,json:{name:"layerDefinition.drawingInfo.renderer",write:oe()}})],T.prototype,"renderer",null),y([h()],T.prototype,"source",void 0),y([h()],T.prototype,"spatialReference",null),y([h({type:qt,json:{name:"layerDefinition.timeInfo",write:!0,origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:!0},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:!0}}}})],T.prototype,"timeInfo",null),y([h({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],T.prototype,"title",null),y([Ft("title")],T.prototype,"writeTitle",null),y([h({json:{read:!1}})],T.prototype,"type",void 0),y([h(P(F(Pt)))],T.prototype,"useViewTime",void 0),y([h({type:Boolean,json:{name:"visibility",write:oe()}})],T.prototype,"visible",void 0),T=y([Ne("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],T);const gn=T;export{hn as A,J as E,mn as F,qe as L,fn as R,Ae as a,Fe as b,yn as c,Y as d,cn as e,Ce as f,ve as g,xe as h,_e as i,je as m,Ze as n,Te as o,Ie as r,Re as s,Ee as t,gn as u,Oe as v};
