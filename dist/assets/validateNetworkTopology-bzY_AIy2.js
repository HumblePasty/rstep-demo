import{s as f,Y as n}from"./index-CdlB_1jZ.js";import{f as l,i as p,s as u}from"./utils-C6_UxkSn.js";import{i as k}from"./WebMap-u3iYo64u.js";import"./ColorBackground-D1ULsJaW.js";import"./Basemap-C-l1VFzS.js";import"./loadAll-DJQRbLYI.js";import"./writeUtils-BpED38n7.js";import"./CollectionFlattener-DXYq1j4X.js";import"./editableLayers-DkMgipBa.js";import"./catalogUtils-CXc9Bdsq.js";import"./basemapUtils-C74MB7Dv.js";import"./TablesMixin-tb_nsbF-.js";import"./jsonContext-gDbq0fo5.js";import"./project-7YK4d_tY.js";import"./utils-BYArndnc.js";import"./NetworkElement-5hKIqbPh.js";async function j(e,t,s){const i=l(e),a=t.toJSON();t.validationSet&&(a.validationSet=JSON.stringify(t.validationSet));const o={...a,returnEdits:!0,f:"json"},d=u({...i.query,...o}),r=p(d,{...s,method:"post"}),c=`${i.path}/validateNetworkTopology`,{data:m}=await n(c,r);return k.fromJSON(v(m))}async function q(e,t,s){if(!t.gdbVersion)throw new f("submit-validate-network-topology-job:missing-gdb-version","version is missing");const i=l(e),a=t.toJSON();t.validationSet&&(a.validationSet=JSON.stringify(t.validationSet));const o=p(i.query,{query:u({...a,returnEdits:!0,async:!0,f:"json"}),...s,method:"post"}),d=`${i.path}/validateNetworkTopology`,{data:r}=await n(d,o);return r?r.statusUrl:null}function v(e){return e.serviceEdits&&(e.serviceEdits=e.serviceEdits.map(t=>(t.editedFeatures.spatialReference&&(t.editedFeatures.spatialReference={wkid:t.editedFeatures.spatialReference.wkid,wkt:t.editedFeatures.spatialReference.wkt,wkt2:t.editedFeatures.spatialReference.wkt2,latestWkid:t.editedFeatures.spatialReference.latestWkid,latestVcsWkid:t.editedFeatures.spatialReference.latestVcsWkid,vcsWkid:t.editedFeatures.spatialReference.vcsWkid}),t={layerId:t.id,editedFeatures:t.editedFeatures}))),e}export{v as handleValidateNetworkTopologyResult,q as submitValidateNetworkTopologyJob,j as validateNetworkTopology};
