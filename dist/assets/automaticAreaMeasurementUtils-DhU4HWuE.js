import{qd as w,lc as X,ld as Y,bZ as Z,U as P,r as o,o as r,p as g,ff as D,qe as v,k2 as U,qf as R,o4 as j,qg as F,qh as m,qi as O,qj as S,qk as d,ql as W,qm as J,a7 as L,ec as Q,qn as N,ky as E,mC as H,e5 as K,eo as G,e3 as tt,qo as et}from"./index-DYg3Dm5u.js";import{B as p,U as nt,C as B,w as it,d as at,A as ot,J as st,e as z,l as rt}from"./automaticLengthMeasurementUtils-DlJpXTx4.js";import{r as lt,e as ut}from"./geodesicLengthMeasurementUtils-398YrD6N.js";import{e as ct}from"./earcut-D9gy186-.js";import{v as pt}from"./triangle-CI1s7hGl.js";function ft(e){const{spatialReference:n}=e;return lt(n,ht,mt,e)}function ht(e){return w(Math.abs(X([e],"square-meters")[0]),"square-meters")}function mt(e){try{return w(Math.abs(Y(e,"square-meters")),"square-meters")}catch{return null}}let s=class extends Z{constructor(e){super(e),this.actual=null,this.lockable=!0,this.id=P(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(e){this.lockable&&this._set("committed",e)}get dirty(){return this.inputValue!=null}get locked(){return this.lockable&&this.committed!=null}onInput(e){this.inputValue=e}onCommit(e,n,t){this.lockable?this._onCommitLockable(e,t):this._onCommitNonLockable(t),this.invalid&&e==="commit-and-exit"||t.onCommit(n,e)}_onCommitLockable(e,n){const{inputValue:t,locked:i}=this;i&&$(t)?this.unlock():(e==="commit-and-exit"&&!i||t!=null)&&this._parseInputAndLock(n)}_onCommitNonLockable(e){const{inputValue:n}=this;$(n)?this.setActual(null):n!=null&&this._parseInputAndSetActual(e)}applyValue(e){this.lockable?this.lock(e):this.setActual(e)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(e){this.actual=e,this.clearInputValue()}lock(e){this.lockable&&(this.committed=e??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(e){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(e))}getSuffix(e){const{suffix:n}=this;return typeof n=="function"?n(e):n}getFormattedValue(e){const{actual:n,committed:t,format:i}=this;return t!=null?i(t,e):n!=null?i(n,e):null}getRawDisplayValue(e){const{actual:n,committed:t,inputValue:i}=this;return i??(this.lockable&&t!=null?this.formatForInputMode(t,e):n!=null?this.formatForInputMode(n,e):null)}_parseInputAndSetActual(e){const{inputValue:n}=this;if(n==null||$(n))return this.setActual(null);const t=this.parse(n,e);t!=null?this.setActual(t):this.invalid=!0}_parseInputAndLock(e){const{inputValue:n,actual:t}=this;if($(n))return this.unlock();if(n==null)return this.lock(t);const i=this.parse(n,e);i!=null?this.lock(i):this.invalid=!0}};function $(e){return e!=null&&e.trim()===""}o([r()],s.prototype,"actual",void 0),o([r()],s.prototype,"committed",null),o([r()],s.prototype,"dirty",null),o([r()],s.prototype,"format",void 0),o([r()],s.prototype,"formatForInputMode",void 0),o([r()],s.prototype,"lockable",void 0),o([r()],s.prototype,"locked",null),o([r()],s.prototype,"id",void 0),o([r()],s.prototype,"inputValue",void 0),o([r()],s.prototype,"name",void 0),o([r()],s.prototype,"parse",void 0),o([r()],s.prototype,"readOnly",void 0),o([r()],s.prototype,"suffix",void 0),o([r()],s.prototype,"title",void 0),o([r()],s.prototype,"visible",void 0),o([r()],s.prototype,"invalid",void 0),o([r()],s.prototype,"unlockOnVertexPlacement",void 0),s=o([g("esri.views.interactive.tooltip.fields.TooltipField")],s);let I=class extends s{constructor(n){super(n),this.showAsZ=!1}normalizeCtorArgs(n){const t=i=>i.inputUnitInfos.verticalLength.unit;return{name:"elevation",actual:D,parse:p({createQuantity:(i,a)=>U(i,t(a))}),format:(i,a)=>a.formatters.verticalLength(i),formatForInputMode:(i,a)=>a.formatters.scalar(v(i,t(a))),suffix:i=>i.inputUnitInfos.verticalLength.abbreviation,title:i=>i.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1,...n}}};o([r()],I.prototype,"showAsZ",void 0),I=o([g("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],I);let x=class extends s{constructor(e){super(e),this.precision=1}normalizeCtorArgs(e){const n=t=>t.inputUnitInfos.angle.unit;return{name:"orientation",actual:null,parse:p({createQuantity:(t,i)=>j(t,n(i),"geographic"),sanitize:B}),format:t=>{const i=R(t);return nt(i,"geographic",this.precision)},formatForInputMode:(t,i)=>{const a=R(t);return i.formatters.scalar(a)},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.orientation,...e}}};o([r()],x.prototype,"precision",void 0),x=o([g("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],x);let A=class extends s{constructor(e){super(e),this.precision=null}normalizeCtorArgs(e){const n=t=>t.inputUnitInfos.length.unit;return{name:"size",actual:null,parse:p({createQuantity:(t,i)=>U(t,n(i))}),format:(t,i)=>i.formatters.length(t),formatForInputMode:(t,i)=>i.formatters.scalar(v(t,n(i))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.size,...e}}};o([r()],A.prototype,"precision",void 0),A=o([g("esri.views.interactive.tooltip.fields.TooltipFieldSize")],A);function Rt(e){const n=i=>i.inputUnitInfos.angle.unit,t=i=>i.sketchOptions.values.effectiveDirectionMode;return new s({name:"direction",actual:F,parse:p({createQuantity:(i,a)=>j(i,n(a),"geographic"),sanitize:B}),format:(i,a)=>{const f=t(a),h=O(i,f);switch(f){case m.Absolute:return a.formatters.direction(h);case m.Relative:return a.formatters.directionRelative(h);case m.RelativeBilateral:return a.formatters.directionRelativeBilateral(h)}},formatForInputMode:(i,a)=>{const f=O(i,t(a));return a.formatters.scalar(v(f,n(a)))},suffix:i=>i.inputUnitInfos.angle.abbreviation,title:i=>{const a=t(i),{absolute:f,relative:h}=i.messages.sketch.direction;switch(a){case m.Absolute:return f;case m.Relative:case m.RelativeBilateral:return h}},...e})}function V(e){const n=t=>t.inputUnitInfos.length.unit;return new s({name:"distance",actual:D,parse:p({createQuantity:(t,i)=>U(Math.max(t,0),n(i))}),format:(t,i)=>i.formatters.length(t),formatForInputMode:(t,i)=>i.formatters.scalar(v(t,n(i))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.distance,...e})}function Ot(e){return V({format:(n,t)=>t.formatters.totalLength(n),title:n=>n.messages.sketch.totalLength,readOnly:!0,...e})}function Qt(e){return V({...e})}function zt(e){const n=t=>t.inputUnitInfos.length.unit;return V({...e,parse:p({createQuantity:(t,i)=>U(t,n(i))}),format:(t,i)=>i.formatters.lengthRelative(t)})}function dt(e){return new I(e)}function Dt(e){return new x(e)}function jt(e){return new A(e)}function Bt(e){return q("scale",{name:"scale",actual:null,parse:p({createQuantity:n=>d(Math.abs(n))}),...e})}function Tt(e){const n=t=>t.inputUnitInfos.area.unit;return new s({name:"area",actual:S,parse:p({createQuantity:(t,i)=>w(t,n(i))}),format:(t,i)=>i.formatters.area(t),formatForInputMode:(t,i)=>i.formatters.scalar(v(t,n(i))),suffix:t=>t.inputUnitInfos.area.abbreviation,title:t=>t.messages.sketch.area,readOnly:!0,...e})}function gt(e){return new s({name:"x",actual:F,parse:at,format:(n,t)=>t.formatters.longitudeDecimalDegrees(n),formatForInputMode:n=>it(n),suffix:n=>n.inputUnitInfos.angle.abbreviation,title:n=>n.messages.sketch.longitude,...e})}function vt(e){return new s({name:"y",actual:F,parse:st,format:(n,t)=>t.formatters.latitudeDecimalDegrees(n),formatForInputMode:n=>ot(n),suffix:n=>n.inputUnitInfos.angle.abbreviation,title:n=>n.messages.sketch.latitude,...e})}function yt(e){return q("x",{name:"x",...e})}function kt(e){return q("y",{name:"y",...e})}function q(e,n){return new s({actual:d(0),parse:p({createQuantity:t=>d(t)}),format:(t,i)=>i.formatters.scalar(t),formatForInputMode:(t,i)=>i.formatters.scalar(t),title:t=>t.messages.sketch[e],...n})}const Xt=e=>{let n=class extends e{constructor(){super(...arguments),this.longitude=gt(),this.latitude=vt(),this.x=yt(),this.y=kt(),this.elevation=dt(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(t,i=t==null?void 0:t.spatialReference){if(this.geographic=!!i&&ut(i),t==null)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){const a=W(t,bt);this._setActualLonLat(z(a==null?void 0:a[0]),z(a==null?void 0:a[1]))}else this._setActualXY(d(t.x),d(t.y))}_setActualLonLat(t,i){this.longitude.actual=t,this.latitude.actual=i}_setActualXY(t,i){this.x.actual=t,this.y.actual=i}};return o([r()],n.prototype,"geographic",void 0),o([r()],n.prototype,"effectiveX",null),o([r()],n.prototype,"effectiveY",null),o([r()],n.prototype,"key",null),n=o([g("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],n),n},bt=[0,0];function $t(e,n=M()){return It(e,n,!1)}function It(e,n,t=e.hasZ){const i=rt(e.spatialReference),a=J(i);if(a==null)return null;const f=(y,c)=>!(c.length<2)&&(Q(y,c[0],c[1],t&&c[2]||0),!0);let h=0;for(const y of e.rings){const c=y.length;if(c<3)continue;const{positionsWorldCoords:u}=n;for(;u.length<c;)u.push(L());const _=xt,k=Q(At,0,0,0),T=1/c;for(let l=0;l<c;l++){if(!f(_,y[l])||!N(_,e.spatialReference,u[l],i))return null;E(k,k,u[l],T)}const C=H(u[0],u[1],k,K());if(G(tt(C))===0)continue;for(let l=0;l<c;l++)et(C,k,u[l],u[l]);const b=wt(u);for(let l=0;l<b.length;l+=3)h+=pt(u[b[l]],u[b[l+1]],u[b[l+2]])}return w(h,a)}const xt=L(),At=L();function M(){return{positionsWorldCoords:[]}}function wt(e){return ct(Ut(e),[],2)}function Ut(e){const n=new Float64Array(2*e.length);for(let t=0;t<e.length;++t){const i=e[t],a=2*t;n[a]=i[0],n[a+1]=i[1]}return n}function Ft(e,n,t=M()){{const i=ft(e);return i??$t(e,t)}}function Yt(e,n=M()){return Ft(e,"on-the-ground",n)}export{Qt as F,Tt as Q,Bt as R,Xt as h,jt as j,Dt as k,Yt as u,Ot as w,zt as x,Rt as y};
