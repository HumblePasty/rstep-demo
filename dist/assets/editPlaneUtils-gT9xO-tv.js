import{r as s,o as r,p as k,bS as ft,ah as it,fH as Gt,hr as ot,sh as A,fz as b,pW as Ct,fw as vt,m3 as Et,tq as Pt,lG as St,tr as At,ts as Ft,tt as Ht,bV as zt,mH as Mt,lO as wt,eJ as Nt,h7 as Lt,k as Zt,tu as st,n as Dt,dG as jt,aS as Y,aj as Yt,m as H,ti as Kt,tv as nt,tw as Wt,tx as rt,ty as qt,tz as Jt,tA as at,tB as Qt,tC as Bt,jZ as I,tD as C,q1 as lt,tE as Xt,tF as te,bh as ee,sr as K,ss as ct,tG as ie,tH as oe,tI as se,tJ as ne,a6 as re,db as ae,h4 as pt,na as dt,e6 as ut,tK as ht}from"./index-CgLC99fU.js";import{r as T,f as le,c as ce,j as pe,m as M,R as de,k as ue,g as he,L as ye,G as ge}from"./automaticLengthMeasurementUtils-Djufaqrk.js";import{e as J}from"./helpMessageUtils-M95XMmyR.js";import{getDrawMeshHelpMessage as me}from"./helpMessageUtils3d-n-Lr7wVE.js";import{h as N,k as fe,R as ve,y as _t,F as Ot,Q as we,w as _e,u as kt}from"./automaticAreaMeasurementUtils-Be8RuqdT.js";import{W as Oe,K as L}from"./boundedPlane-CcAP6iN5.js";var y;(function(t){t[t.NeverApplied=0]="NeverApplied",t[t.Applied=1]="Applied",t[t.Undone=2]="Undone"})(y||(y={}));var w;(function(t){t.UndoRedoUpdating="UndoRedoUpdating",t.UndoInvalidError="UndoInvalidError",t.RedoInvalidError="RedoInvalidError",t.ApplyInvalidError="ApplyInvalidError"})(w||(w={}));const Z={[w.UndoRedoUpdating]:"Cannot perform operation whilst undo redo is updating",[w.UndoInvalidError]:"There are no items to Undo",[w.RedoInvalidError]:"There are no items to Redo",[w.ApplyInvalidError]:"Cannot apply an item that is already applied"};let E=class extends Error{constructor(){super(Z[w.UndoRedoUpdating]),this.type="undo-redo-updating-error"}},q=class extends Error{constructor(){super(Z[w.UndoInvalidError]),this.type="undo-redo-undo-error"}};class yt extends Error{constructor(){super(Z[w.RedoInvalidError]),this.type="undo-redo-redo-error"}}class ke extends Error{constructor(){super(Z[w.ApplyInvalidError]),this.type="undo-redo-apply-error"}}var O;(function(t){t[t.Apply=0]="Apply",t[t.Undo=1]="Undo",t[t.Redo=2]="Redo"})(O||(O={}));let z=class extends ft{constructor(){super(...arguments),this.name="",this.tag=Symbol(),this.status=y.NeverApplied}get canUndo(){return this.status===y.Applied}get canRedo(){return this.status===y.Undone}async executeUndoRedoOperation(t){switch(t){case O.Apply:if(this.status!==y.NeverApplied)throw new ke;return await this.apply(),void(this.status=y.Applied);case O.Undo:if(this.status!==y.Applied)throw new q;return await this.undo(),void(this.status=y.Undone);case O.Redo:if(this.status!==y.Undone)throw new q;return await this.redo(),void(this.status=y.Applied)}}};s([r()],z.prototype,"name",void 0),s([r()],z.prototype,"tag",void 0),z=s([k("esri.undoredo.UndoableOperation")],z);let v=class extends ft{constructor(){super(...arguments),this._stack=new it,this._stackPosition=-1,this._updatingHandles=new Gt}get updating(){return this._updatingHandles.updating}get canUndo(){return this.hasUndo&&!this.updating}get hasUndo(){return this._stackPosition>=0}get canRedo(){return this.hasRedo&&!this.updating}get hasRedo(){return this._stackPosition<this._stack.length-1}_truncateForwardStack(){this._stack.splice(this._stackPosition+1,this._stack.length-this._stackPosition).forEach(t=>t.destroy())}_drainStack(){this._stack.drain(t=>t.destroy()),this._stackPosition=-1}async undo(){if(!this.hasUndo)throw new q;if(this.updating)throw new E;const t=this._stack.getItemAt(this._stackPosition);t&&await this._updatingHandles.addPromise((async()=>{await t.executeUndoRedoOperation(O.Undo),--this._stackPosition,t.canRedo||this._truncateForwardStack()})())}async redo(){if(!this.hasRedo)throw new yt;if(this.updating)throw new E;const t=this._stack.getItemAt(this._stackPosition+1);if(!t)throw new yt;await this._updatingHandles.addPromise((async()=>{await t.executeUndoRedoOperation(O.Redo),++this._stackPosition})())}peekUndo(){if(this.canUndo)return this._stack.getItemAt(this._stackPosition)}peekRedo(){if(this.canRedo)return this._stack.getItemAt(this._stackPosition+1)}async inject(t){if(this.updating)throw new E;await this._updatingHandles.addPromise((async()=>{t.status===y.NeverApplied&&await t.executeUndoRedoOperation(O.Apply),t.canUndo?(this._stack.splice(this._stackPosition+1,0,t),this._stackPosition++):this._stackPosition>-1&&(this._stack.splice(0,this._stackPosition+1).forEach(e=>e.destroy()),this._stackPosition=-1)})())}async add(t){if(this.updating)throw new E;await this._updatingHandles.addPromise((async()=>{t.status===y.NeverApplied&&await t.executeUndoRedoOperation(O.Apply),this._stackPosition>=-1&&this._truncateForwardStack(),t.canUndo?(this._stack.push(t),this._stackPosition=this._stack.length-1):this._drainStack()})())}async removeTagged(t,e=!1){if(this.updating&&!e)return;await ot(()=>!this.updating);const i=new it;for(let o=0;o<this._stack.length;o++){const n=this._stack.getItemAt(o);n&&(n.tag===t?(n.destroy(),o===this._stackPosition&&(this._stackPosition=i.length-1)):i.push(n))}this._stack=i,this._stackPosition>i.length-1&&(this._stackPosition=i.length-1)}async clear(t=!1){if(this.updating&&!t)throw new E;await ot(()=>!this.updating),this._drainStack()}};s([r()],v.prototype,"_stack",void 0),s([r()],v.prototype,"_stackPosition",void 0),s([r()],v.prototype,"updating",null),s([r({readOnly:!0})],v.prototype,"canUndo",null),s([r({readOnly:!0})],v.prototype,"hasUndo",null),s([r({readOnly:!0})],v.prototype,"canRedo",null),s([r({readOnly:!0})],v.prototype,"hasRedo",null),v=s([k("esri.UndoRedo")],v);class xe{constructor(){this.committedVertices=null,this.cursorVertex=null,this.full=null,this.outline=null,this.cursorEdge=null,this.circle=null,this.rectangle=null}}let _=class extends T{constructor(e){super(e),this.type="draw-circle",this.radius=null,this.xSize=null,this.ySize=null,this.area=A}get allFields(){return[]}};s([r()],_.prototype,"type",void 0),s([r()],_.prototype,"radius",void 0),s([r()],_.prototype,"xSize",void 0),s([r()],_.prototype,"ySize",void 0),s([r()],_.prototype,"area",void 0),s([r()],_.prototype,"allFields",null),_=s([k("esri.views.interactive.tooltip.infos.DrawCircleTooltipInfo")],_);let P=class extends N(T){constructor(e){super(e),this.type="draw-mesh",this.orientation=fe({lockable:!1}),this.scale=ve({lockable:!1})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};s([r()],P.prototype,"helpMessage",void 0),s([r()],P.prototype,"allFields",null),P=s([k("esri.views.interactive.tooltip.infos.DrawMeshTooltipInfo")],P);let S=class extends N(T){constructor(t){super(t),this.type="draw-point"}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};s([r()],S.prototype,"helpMessage",void 0),s([r()],S.prototype,"allFields",null),S=s([k("esri.views.interactive.tooltip.infos.DrawPointTooltipInfo")],S);let U=class extends N(T){constructor(e){super(e),this.type="draw-polygon",this.direction=_t(),this.distance=Ot(),this.area=we(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.area]}};s([r()],U.prototype,"xyMode",void 0),s([r()],U.prototype,"helpMessage",void 0),s([r()],U.prototype,"allFields",null),U=s([k("esri.views.interactive.tooltip.infos.DrawPolygonTooltipInfo")],U);let V=class extends N(T){constructor(t){super(t),this.type="draw-polyline",this.direction=_t(),this.distance=Ot(),this.totalLength=_e(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.totalLength]}};s([r()],V.prototype,"helpMessage",void 0),s([r()],V.prototype,"xyMode",void 0),s([r()],V.prototype,"allFields",null),V=s([k("esri.views.interactive.tooltip.infos.DrawPolylineTooltipInfo")],V);let x=class extends T{constructor(t){super(t),this.type="draw-rectangle",this.xSize=b,this.ySize=b,this.area=A}get allFields(){return[]}};s([r()],x.prototype,"type",void 0),s([r()],x.prototype,"xSize",void 0),s([r()],x.prototype,"ySize",void 0),s([r()],x.prototype,"area",void 0),s([r()],x.prototype,"allFields",null),x=s([k("esri.views.interactive.tooltip.infos.DrawRectangleTooltipInfo")],x);function $e(t,e){return{point:new S({sketchOptions:e,viewType:t}),polyline:new V({sketchOptions:e,viewType:t}),polygon:new U({sketchOptions:e,viewType:t}),mesh:new P({sketchOptions:e,viewType:t}),rectangle:new x({sketchOptions:e}),circle:new _({sketchOptions:e})}}function gt(t){const{directionOptions:e,geometryType:i,sketchOptions:o,tooltipInfos:n}=t,a=h=>{const l=D(t).mode,u=n[h].elevation;l==="relative-to-ground"||l==="relative-to-scene"||l==="on-the-ground"?u.lock(B(t)):u.unlock()},p=h=>{if(e){const l=n[h].direction;l.committed=e.angle,l.unlockOnVertexPlacement=!1,o.values.directionMode=e.mode}};switch(i){case"polygon":case"polyline":a(i),p(i);break;case"point":case"mesh":a(i)}}function be(t,e){const{drawOperation:i,view:o}=e,n=Q(e),a=D(e);if(o.type==="2d"||!t||a.mode!=="absolute-height"||(i==null?void 0:i.numCommittedVertices)!==1||!n||n.type!=="draw-polyline"&&n.type!=="draw-polygon"||n.elevation.locked)return;const[p,h,l]=t,u=Fe(p,h,l,a,e);u!=null&&n.elevation.lock(u)}function mt(t){var e;(e=Q(t))==null||e.allFields.forEach(i=>{i.unlockOnVertexPlacement&&i.unlock()})}function Q({geometryType:t,graphic:e,tooltipInfos:i}){var o;return t==="multipoint"||((o=e==null?void 0:e.geometry)==null?void 0:o.type)!==Ie[t]?null:i[t]}const Ie={point:"point",mesh:"mesh",polyline:"polyline",polygon:"polygon",circle:"polygon",rectangle:"polygon"};function Ue(t,e){switch(t==null?void 0:t.type){case"draw-point":Ve(t,e);break;case"draw-polyline":Re(t,e);break;case"draw-polygon":Ge(t,e);break;case"draw-rectangle":Ee(t,e);break;case"draw-circle":Pe(t,e);break;case"draw-mesh":Te(t,e)}}function Ve(t,e){var o;const i=(o=e.graphic)==null?void 0:o.geometry;(i==null?void 0:i.type)==="point"&&(xt(t,i,e),t.helpMessage=J("point",i))}function Te(t,e){const{graphic:i,view:o}=e,n=i==null?void 0:i.geometry;o.type!=="3d"||n&&n.type!=="mesh"||(xt(t,n==null?void 0:n.origin,e),n&&le(t,n),t.helpMessage=me(i,o))}function xt(t,e,i){const{drawOperation:o,view:n,sketchOptions:a}=i,{cursorVertex:p}=o;if(t.sketchOptions=a,t.viewType=n.type,t.setLocationFromPoint(e,R(i)),bt(t.elevation,i),!p)return void(o.constraints=void 0);const h=p;o.constraints={context:Tt(h,i),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:null,direction:null}}function Re(t,e){const{createOperationGeometry:i,drawOperation:o}=e,n=i!=null?i.full:null;n&&n.type!=="polyline"||($t(t,e),t.totalLength.actual=o.lastVertex?(n?ce(n):null)??b:null,t.helpMessage=J("polyline",n))}function Ge(t,e){const{createOperationGeometry:i,drawOperation:o}=e,n=i!=null?i.full:null;n&&n.type!=="polygon"||($t(t,e),t.area.actual=o.lastVertex?(n?kt(n):null)??A:null,t.helpMessage=J("polygon",n))}function $t(t,e){const{drawOperation:i,sketchOptions:o,view:n}=e,{cursorVertex:a,lastVertex:p,secondToLastVertex:h}=i,l=o.values.effectiveDirectionMode;t.sketchOptions=o,t.viewType=n.type;const u=p&&a?M(p,a)??b:null;if(t.distance.actual=u,t.distance.readOnly=p==null,t.direction.actual=null,t.direction.readOnly=!0,p&&a&&(l==="absolute"||h)){const G=At(h,p,a,l);t.direction.actual=G??Ft,t.direction.readOnly=!1}t.setLocationFromPoint(a,R(e)),bt(t.elevation,e);const m=Ce(p,e);t.xyMode=m,t.direction.visible=m==="direction-distance",t.distance.visible=m==="direction-distance",t.effectiveX.visible=m==="coordinates",t.effectiveY.visible=m==="coordinates";const f=a??p;i.constraints=f?{context:Tt(f,e),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:t.distance.committed,direction:t.direction.committed}:void 0}function Ce(t,{sketchOptions:e}){const i=e.tooltips.xyMode;return i==="auto"?t?"direction-distance":"coordinates":i}function Ee(t,e){t.sketchOptions=e.sketchOptions,t.xSize=Ut(e),t.ySize=Vt(e),t.area=It(e)}function Pe(t,e){const{forceUniformSize:i,sketchOptions:o}=e;t.sketchOptions=o,t.radius=i?Se(e):null,t.xSize=i?null:Ut(e),t.ySize=i?null:Vt(e),t.area=It(e)}function bt(t,e){const{drawOperation:i}=e,o=(i==null?void 0:i.cursorVertex)??(i==null?void 0:i.lastVertex);t.actual=de(o)??B(e),t.visible=i.hasZ,t.readOnly=!1,t.showAsZ=!0}function It(t){var i;const e=(i=t.createOperationGeometry)==null?void 0:i.full;return(e==null?void 0:e.type)!=="polygon"?A:kt(e)??A}function Ut(t){var i,o;const e=(o=(i=t.createOperationGeometry)==null?void 0:i.rectangle)==null?void 0:o.midpoints;return(e!=null?M(e.left,e.right):null)??b}function Vt(t){var i,o;const e=(o=(i=t.createOperationGeometry)==null?void 0:i.rectangle)==null?void 0:o.midpoints;return(e!=null?M(e.top,e.bottom):null)??b}function Se({createOperationGeometry:t}){var e;return(((e=t==null?void 0:t.circle)==null?void 0:e.center)!=null&&t.circle.edge!=null?M(t.circle.center,t.circle.edge):null)??b}function Ae(t){const{geometryType:e,tooltipInfos:i}=t;switch(e){case"point":case"mesh":case"polyline":case"polygon":{const o=i[e].elevation.committed;return o?Ct(o,"meters")/vt(R(t)):void 0}default:return}}function Fe(t,e,i,o,n){const{view:a,drawOperation:p}=n;if(a.type!=="3d"||!p)return;i??(i=0);const h=R(n),l=D(n),u=Pt(a,t,e,i,h,l,o);return pe(u,h)??B(n)}function D(t){return t.drawOperation.elevationInfo??Et}function R(t){return t.drawOperation.coordinateHelper.spatialReference}function B(t){const e=vt(R(t));return St(t.defaultZ*e,"meters")}function Tt(t,e){return Ht(t,e.view,R(e),D(e),e.drawOperation.coordinateHelper.hasZ(),e.sketchOptions.values.effectiveDirectionMode)}let c=class extends zt.EventedMixin(Mt){constructor(t){super(t),this._graphic=null,this._coordinateFormatterLoadTask=null,this._createOperationGeometry=null,this.defaultZ=0,this.directionOptions=null,this.geometryType=null,this.hasZ=!0,this.geometryToPlace=null,this.snappingManager=null,this.snapToScene=!1,this.sketchOptions=new wt}initialize(){const{view:t}=this;this.internalGraphicsLayer=new Nt({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer);const e=this.drawOperation=this.makeDrawOperation();this.tooltipInfos=$e(t.type,this.sketchOptions);const i=ue(()=>({view:t,options:this.sketchOptions.tooltips}));this.tooltip=i,gt(this._tooltipsContext),this._coordinateFormatterLoadTask=Lt(()=>he()),this.addHandles([e.on("vertex-add",o=>this.onVertexAdd(o)),e.on("vertex-remove",o=>this.onVertexRemove(o)),e.on("vertex-update",o=>this.onVertexUpdate(o)),e.on("cursor-update",o=>this.onCursorUpdate(o)),e.on("cursor-remove",()=>this._updateGraphic()),e.on("complete",o=>this.onComplete(o)),this._coordinateFormatterLoadTask,i.on("paste",o=>ye(o,this.activeTooltipInfo)),Zt(()=>this.cursor,o=>{e.cursor=o},Dt),st(()=>{const{activeTooltipInfo:o,sketchOptions:n}=this;Ue(o,this._tooltipsContext),i.info=n.tooltips.effectiveEnabled?o:null}),st(()=>{e.constraintZ=Ae(this._tooltipsContext)},jt)]),this.finishToolCreation()}destroy(){this.drawOperation=Y(this.drawOperation),this.tooltip=Y(this.tooltip),this._destroyAllVisualizations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=Y(this.internalGraphicsLayer),this._set("view",null)}get _drawSpatialReference(){return this.drawOperation.coordinateHelper.spatialReference}get _tooltipsContext(){return{createOperationGeometry:this._createOperationGeometry,defaultZ:this.defaultZ,directionOptions:this.directionOptions,drawOperation:this.drawOperation,forceUniformSize:this.forceUniformSize,geometryType:this.geometryType,graphic:this.graphic,sketchOptions:this.sketchOptions,tooltipInfos:this.tooltipInfos,view:this.view}}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(t){this._set("centered",t),this._updateGraphic()}get cursor(){return this._get("cursor")}set cursor(t){this._set("cursor",t)}set enabled(t){this.drawOperation.interactive=t,this._set("enabled",t)}set forceUniformSize(t){this._set("forceUniformSize",t),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(t){this._set("graphicSymbol",t),this._graphic!=null&&(this._graphic.symbol=t)}set mode(t){const e=this.drawOperation;e&&(e.drawingMode=t),this._set("mode",t)}get updating(){var t;return((t=this.drawOperation)==null?void 0:t.updating)??!1}get undoRedo(){const{view:{type:t,map:e}}=this;return t==="2d"&&e&&"undoRedo"in e&&e.undoRedo instanceof v?e.undoRedo:null}set undoRedo(t){this._override("undoRedo",t)}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(t){this.destroyed||ge(t,this.tooltip)||this.drawOperation.onInputEvent(t)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo(),this.drawOperation.numCommittedVertices===0&&gt(this._tooltipsContext)}_destroyAllVisualizations(){this.removeHandles(g.outline),this.removeHandles(g.regularVertices),this.removeHandles(g.activeVertex),this.removeHandles(g.activeEdge),this.removeHandles(W)}_createOrUpdateGraphic(t){if(this._graphic!=null)return this.updateGraphicGeometry(t),this._graphic;const e=new Yt({...this.graphicProperties,symbol:this.graphicSymbol});return this._graphic=e,this.updateGraphicGeometry(t),this.internalGraphicsLayer.add(e),this.addHandles(this.initializeGraphic(e)),this.notifyChange("graphic"),this.addHandles(H(()=>{this.internalGraphicsLayer.remove(e),this._graphic===e&&(this._graphic=null)}),W),e}updateGraphicGeometry(t){this._graphic.geometry=t}_getCreateOperationGeometry(t={operationComplete:!1}){var X,tt;if(this.drawOperation==null)return;const{coordinateHelper:e,view:i,visualizationCursorVertex:o,lastVertex:n,committedVertices:a,geometryIncludingUncommittedVertices:p,numCommittedVertices:h}=this.drawOperation;if(!(h>0||o!=null))return;const l=t.operationComplete?a:p,u=l.length,m=o!=null?e.pointToArray(o):null,f=this._drawSpatialReference,G=i.type==="3d"&&i.viewingMode==="global",d=new xe;d.committedVertices=a,d.cursorVertex=m;const{geometryType:j}=this;switch(j){case"point":case"mesh":d.full=e.arrayToPoint(l[0]);break;case"multipoint":d.full=u>0?Bt(l,f):null;break;case"polyline":case"polygon":u>0&&(d.full=j==="polygon"?Jt([l],f,G,!0):at([l],f,G),d.cursorEdge=m!=null&&n&&!Qt(o,n)?at([[m,e.pointToArray(n)]],f,G):null,d.outline=u>1?d.full:null);break;case"circle":case"rectangle":{if(d.committedVertices=d.cursorVertex=null,!u)break;const $=Kt(i,l[0]),F=l[0],et=$.makeMapPoint(F[0]+He*i.resolution,F[1]);j==="circle"?u===1&&t.operationComplete?d.circle=nt([F,et],$,!0):u===2&&(this.forceUniformSize?d.circle=nt(l,$,this.centered):d.rectangle=Wt(l,$,this.centered)):u===1&&t.operationComplete?d.rectangle=rt([F,et],$,!0):u===2&&(d.rectangle=this.forceUniformSize?rt(l,$,this.centered):qt(l,$,this.centered)),d.full=d.circle!=null?d.circle.geometry:(X=d.rectangle)==null?void 0:X.geometry,d.outline=((tt=d.full)==null?void 0:tt.type)==="polygon"?d.full:null;break}default:return null}return d}initializeGraphic(t){return H()}onComplete(t){if(!this.drawOperation)return;this._updateGraphic();let e=null;if(this.drawOperation.isCompleted){const i=this._getCreateOperationGeometry({operationComplete:!0});i!=null&&(e=this._createOrUpdateGraphic(i.full))}this._createOperationGeometry=null,this.emit("complete",{graphic:e,...t})}onCursorUpdate(t){this._updateGraphic(),this.emit("cursor-update",t)}onDeactivate(){const{drawOperation:t}=this;t&&(t.isCompleted||t.cancel())}onOutlineChanged(t){return H()}onCursorEdgeChanged(t){return H()}onVertexAdd(t){var e;mt(this._tooltipsContext),this._updateGraphic(),be((e=t.vertices.at(0))==null?void 0:e.coordinates,this._tooltipsContext),this.emit("vertex-add",t)}onVertexRemove(t){mt(this._tooltipsContext),this._updateGraphic(),this.emit("vertex-remove",t)}onVertexUpdate(t){this._updateGraphic(),this.emit("vertex-update",t)}_updateGraphic(){const t=this._getCreateOperationGeometry();this._createOperationGeometry=t,t!=null?(t.cursorEdge!=null?this.addHandles(this.onCursorEdgeChanged(t.cursorEdge),g.activeEdge):this.removeHandles(g.activeEdge),t.outline!=null?this.addHandles(this.onOutlineChanged(t.outline),g.outline):this.removeHandles(g.outline),t.committedVertices!=null?this.addHandles(this.onRegularVerticesChanged(t.committedVertices),g.regularVertices):this.removeHandles(g.regularVertices),t.cursorVertex!=null?this.addHandles(this.onActiveVertexChanged(t.cursorVertex),g.activeVertex):this.removeHandles(g.activeVertex),t.full!=null?this._createOrUpdateGraphic(t.full):this.removeHandles(W)):this._destroyAllVisualizations()}get activeTooltipInfo(){var t;return(t=this._coordinateFormatterLoadTask)!=null&&t.finished?Q(this._tooltipsContext):null}};s([r()],c.prototype,"_coordinateFormatterLoadTask",void 0),s([r()],c.prototype,"_createOperationGeometry",void 0),s([r()],c.prototype,"_tooltipsContext",null),s([r({value:!0})],c.prototype,"centered",null),s([r()],c.prototype,"cursor",null),s([r({nonNullable:!0})],c.prototype,"defaultZ",void 0),s([r({constructOnly:!0})],c.prototype,"directionOptions",void 0),s([r()],c.prototype,"drawOperation",void 0),s([r({value:!0})],c.prototype,"enabled",null),s([r({value:!0})],c.prototype,"forceUniformSize",null),s([r({constructOnly:!0})],c.prototype,"geometryType",void 0),s([r()],c.prototype,"graphic",null),s([r({constructOnly:!0})],c.prototype,"graphicProperties",void 0),s([r()],c.prototype,"graphicSymbol",null),s([r({constructOnly:!0})],c.prototype,"hasZ",void 0),s([r({constructOnly:!0})],c.prototype,"geometryToPlace",void 0),s([r()],c.prototype,"mode",null),s([r()],c.prototype,"snappingManager",void 0),s([r()],c.prototype,"snapToScene",void 0),s([r()],c.prototype,"tooltip",void 0),s([r()],c.prototype,"tooltipInfos",void 0),s([r({constructOnly:!0,type:wt})],c.prototype,"sketchOptions",void 0),s([r()],c.prototype,"updating",null),s([r({constructOnly:!0,nonNullable:!0})],c.prototype,"view",void 0),s([r({constructOnly:!0})],c.prototype,"undoRedo",null),s([r()],c.prototype,"activeTooltipInfo",null),c=s([k("esri.views.draw.DrawGraphicTool")],c);const W=Symbol("create-operation-graphic"),g={outline:Symbol("outline-visual"),regularVertices:Symbol("regular-vertices-visual"),activeVertex:Symbol("active-vertex-visual"),activeEdge:Symbol("active-edge-visual")};function Xe(t){switch(t){case"point":case"polyline":case"polygon":case"multipoint":return t;case"circle":case"rectangle":return"segment";case"mesh":return"point"}}const He=48;function ti(t,e){return Rt(t,e,!1)}function ei(t,e){return Rt(t,e,!0)}function Rt(t,e,i){if(t instanceof ie){if(t.operation instanceof oe)return ze(t.operation,e,i),!0;if(t.operation instanceof se)return Me(t.operation,e,i),!0;if(t.operation instanceof ne)return Ne(t.operation,e,i),!0}return!1}function ze(t,e,i=!1){const o=i?-1:1,n=re(o*t.dx,o*t.dy,o*t.dz);ae(e.origin,e.origin,n),L(e)}function Me(t,e,i=!1){const o=i?-t.angle:t.angle;pt(e.basis1,e.basis1,dt,o),pt(e.basis2,e.basis2,dt,o),L(e)}function Ne(t,e,i=!1){const o=i?1/t.factor1:t.factor1,n=i?1/t.factor2:t.factor2;ut(e.basis1,e.basis1,o),ut(e.basis2,e.basis2,n),ht(e.origin,e.origin,t.origin,t.axis1,o),ht(e.origin,e.origin,t.origin,t.axis2,n),L(e)}function ii(t,e,i,o){o||(o=Oe());const n=I(C.get(),t[1],-t[0]),a=I(C.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),p=I(C.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),h=C.get();e.components.forEach(m=>m.vertices.forEach(({pos:f})=>{I(h,lt(t,f),lt(n,f)),Xt(a,a,h),te(p,p,h)}));const l=1e-6,u=I(C.get(),p[0]-a[0]<l?i/2:0,p[1]-a[1]<l?i/2:0);return ee(a,a,u),K(p,p,u),ct(o.basis1,t,(p[0]-a[0])/2),ct(o.basis2,n,(p[1]-a[1])/2),I(o.origin,a[0]*t[0]+a[1]*n[0],a[0]*t[1]+a[1]*n[1]),K(o.origin,o.origin,o.basis1),K(o.origin,o.origin,o.basis2),L(o),o}export{ei as E,ii as F,c as I,Xe as M,ti as d};
